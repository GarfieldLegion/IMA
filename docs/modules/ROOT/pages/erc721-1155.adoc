.ERC721/1155 Flow with Manual Mapping

ifdef::env-github[image::https://www.plantuml.com/plantuml/svg/ZPDHJzim4CVVyobEJ9hQ35h1ooH025gODerkKrV4mxG7KryJgyuvyZb0jUwxBpcdLI84cjzyll__xdwvN79GFbI5JSuvR2nU96ePpAC9cskZCgyA-9D0VIPgkSwygqXFdNKUxdCJK5vk3M6CJMoTLCV-9kVZrcmxKuO8mpQHEabZKS9CbQMXJEIdQVhzYT3373F30Js3njAw3MgucKy_dXodgIHUO-dOX8bxZc49ZfJMyRfmQwJ9Hhm6mpDvtVxyUdLx0zDS6ThsgrrB3MvBJAqZREiycP13OIZ0UtYeF9trXLVC9gEU46PrDleqFNjbejPPMfmfKXdw_ve1IOCGwt2C11TU4Q_G-mx6EsxQAqll7d5NibScFZN6NKNBbT_4h6CqXdOEHx_UFJIV_52x453_FhfuZVfut9rTw38i6tRZyTuhyuXqg1NduWMXdH5KuIW3IKFIHnMZPwZOx8AylbbyXfNpS90fFeY6PWM3TaADIwEH8JZ0PnFIT0Y6ON0yWbL56chn44AEb41xzhGbqe4b0cuKGYkUgIkAYapO_73ExgCZZyjS-GmRtRso5aFa5i_Qs9YBbX469oEG7qGQ7CQiboZxpKWkWo8jUze2RHjxOz-akqQxSCsS_M-AfCqgUGdXzDkd1No8bdVpBt7bjJmrrzBLTo6ic34mE89ExzrLvk3AvBA-LuNz1m00[]]
ifndef::env-github[]

[plantuml]
....
@startuml
<style>
activityDiagram {
    BackgroundColor White
    LineColor Black
  }
</style>
|Mainnet|
start
group Mapping
    :**Owner Registers deployed ERC721**
    DepositBoxERC721
    .addERC721TokenByOwner();
    |SKALE Chain|
    :**Owner Deploys ERC721Clone**
    with mint & burn;
    :**Owner Assigns ERC721Clone Minter**;
    :**Owner Registers**
    TokenManagerERC721
    .addERC721TokenByOwner();
end group
|Mainnet|
group Transferring
    :**User Approves**
    ERC721
    .approve();
    :**User Deposits**
    DepositBoxERC721
    .depositERC721();
    -[#black,dotted]->
    |SKALE Chain|
    ://TokenManager mints clone//;
    -[#green,dashed]-> transfer among 
    end-users using 
    skETH for "gas";
    if (**User decides to exit**) is (1. fund ETH) then
        |Mainnet|
        :**User funds ETH**
        CommunityPool
        .rechargeUserWallet();
        kill
    else (2. start exit)
        |SKALE Chain|
        :**User exits and burns clone**
        TokenManagerERC721
        .exitToMainERC721();
    endif
    |Mainnet|
    :NFT + TokenURI Minted
    URI points to assets on SKALE Chain;
end group
stop
@enduml
....

endif::[]

## One-time Setup Steps

. [Mainnet] Owner registers ERC721
. [SKALE Chain] Owner deploys clone
. [SKALE Chain] Owner assigns clone minter
. [SKALE Chain] Owner registers clone

## Transfer Flow

Deposit

. [Mainnet] User Approves ERC721 transfer
. [Mainnet] User deposits ERC721 to DepositBox
. [SKALE Chain] User can now transfer clone

Withdrawal

. [Mainnet] User funds CommunityPool ETH for exit
. [SKALE Chain] User exits from TokenManager
. [Mainnet] User can now transfer ERC721


.ERC721 Flow with Automatic Mapping

ifdef::env-github[image::https://www.plantuml.com/plantuml/svg/VLB1Rjf04BtxAqRf1L0mIYwLqYWA4AHA3MhLKd6eUbYyWrcndhLsnabGwR_N7flK4attPC-yz-RDsxrdCL6gmYUtB0UFTud9n3qvEJmuaqTJmAy4wZCpsJwFeI8x3pv4ME-Se7OU7M5Rc_aQLDT-9xUJJkouD8u8vPWqv1AMfYmTvKeyVliqVLp0V5T3ZbfHB_frCnfzVYQCm2WCff9WiVJXC1ffUnNsI4j39iUu-3f_VtsbvHJ9R3nEQtXXn6KFoXaCFsZthvVp2S_DEjwnT0DgPc0di_3IbxUE6_tr2Jn8qxGMHxAWwtLBhg8XtcACtQRdaxypHfYMPGnFoDt8_Y3JjjHvZz6vul-RRAjjwQGm_l5kqzpEfGqYQ7-ExzwuWfl9f1yk58w48VE1a2UJLx4y8jAbDRnJCP1kPJ15e1mKXcJ75MDagDYTYhnVh3x2DaIuo0rVj89k2uDkHOkPiyWW0V35rTSn1CSmk4fXMv65cZm4sI4fxppRNbfAu8QXSRLd7egY8YU7Bo7urseQCTkPc6F3MnllKJIuxkoTRx7e6M5mdROFLGqEjN6MvPcP1ijWoCAcYjGbUZBszejMTmrt5Pez-vUg0RljlnvOH8-6qKABxxzGbb0cz_L_LVW_[]]
ifndef::env-github[]

[plantuml]
....
@startuml
<style>
activityDiagram {
    BackgroundColor White
    LineColor Black
  }
</style>
|Mainnet|
group Mapping
    |SKALE Chain|
    start
    :**Owner sets autodeploy**
    TokenManagerERC721
    .enableAutomaticDeploy();
    |Mainnet|
    :**Owner sets whitelist**
    DepositBoxERC721
    .disableWhitelist(...);
end group
group Transferring
    |Mainnet|
    :**User Approves**
    ERC721
    .approve();
    :**User Deposits**
    DepositBoxERC721
    .depositERC721();
    -[#black,dotted]->
    |SKALE Chain|
    ://TokenManager mints clones//;
    -[#green,dashed]-> transfer among 
    end-users using 
    skETH for "gas";
    if (**User decides to exit**) is (1. fund ETH) then
        |Mainnet|
        :**User funds ETH**
        CommunityPool
        .rechargeUserWallet();
        kill
    else (2. start exit)
        |SKALE Chain|
        :**User exits and burns clone**
        TokenManagerERC721
        .exitToMainERC721();
    endif
    |Mainnet|
    :released ERC721;
end group
stop
@enduml
....

endif::[]

## One-time Setup Steps

. [SKALE Chain] Owner sets Autodeploy Mapping
. [Mainnet] Owner sets whitelist

## Transfer Flow

Deposit

. [Mainnet] User Approves ERC721 transfer
. [Mainnet] User deposits ERC721 to DepositBox
. [SKALE Chain] User can now transfer clone

Withdrawal

. [Mainnet] User funds CommunityPool ETH for exit
. [SKALE Chain] User exits from TokenManager
. [Mainnet] User can now transfer ERC721

.ERC1155 Flow with Automatic Mapping

ifdef::env-github[image::https://www.plantuml.com/plantuml/svg/XLB1Qjj04BthAuRqOfj4ne5GI4E8xHWAZMbfNNmeFQorOtdnQbRiZ9AOkl_UrMfjNDnGdSJRUVFUl9a75kMbgMnsnxApU9-fGiopaTsZKQLN5VpA87mJLMnBxnhIKsUTX-N62CQN9qFOOHCRYWBsExiRfcRxkJ94AFki9TSmLtLjg8p4_RTFuwSPJ3UXP1-Hw2N-tGu6dry8FJ0AWsh4QQojsmq6yNdXjaXpHQf4F_iw7OrkRYAU8wcLnN6ehvIOuZ6IUlqFdU3HpBd4IpkFDIn98J0T6vcurx_wQyEjmF9GtSlpF7H7qX07J6Ckl29Ue_TfrdFfxumUndNjtJDoqWnAxwz7dP3gdfBr8oFPul-uxE247NfS_NYtQZTqgPq8wfzNzs-iuNOuF0qOAaF2K5X7oCFXiLdf4UbIAzx4PY1fQ52Len9Y6PA-QXWzGyFc0F9sjlW8Q-VXebHyqJKqQ-Yb8JKMHYE3EC1N4pRI1yFG6-MmRaX38FT1DaYHTvxkILwHm2sZ2on-KrTL3HdPVN7E7j7SOx5HliIMjrJMegJWuhSrjgj5omYzwxmxrcYm7n_EiZmpqzOoADAmQZobH9EnjwywsMl92zSEUhBM5B5P_-l8F5fKZ1eIuVHCMLoTFI3ffh9_0000[]]
ifndef::env-github[]

[plantuml]
....
@startuml
<style>
activityDiagram {
    BackgroundColor White
    LineColor Black
  }
</style>
|Mainnet|
group Mapping
    |SKALE Chain|
    start
    :**Owner sets autodeploy**
    TokenManagerERC1155
    .enableAutomaticDeploy();
    |Mainnet|
    :**Owner sets whitelist**
    DepositBoxERC1155
    .disableWhitelist(...);
end group
group Transferring
    |Mainnet|
    :**User Approves**
    ERC721
    .approve();
    :**User Deposits**
    DepositBoxERC1155
    .depositERC1155();
    -[#black,dotted]->
    |SKALE Chain|
    ://TokenManager mints clones//;
    -[#green,dashed]-> transfer among 
    end-users using 
    skETH for "gas";
    if (**User decides to exit**) is (1. fund ETH) then
        |Mainnet|
        :**User funds ETH**
        CommunityPool
        .rechargeUserWallet();
        kill
    else (2. start exit)
        |SKALE Chain|
        :**User exits and burns clone**
        TokenManagerERC1155
        .exitToMainERC1155();
    endif
    |Mainnet|
    :released ERC1155;
end group
stop
@enduml
....

endif::[]

## One-time Setup Steps

. [SKALE Chain] Owner sets Autodeploy Mapping
. [Mainnet] Owner sets whitelist

## Transfer Flow

Deposit

. [Mainnet] User Approves ERC1155 transfer
. [Mainnet] User deposits ERC1155 to DepositBox
. [SKALE Chain] User can now transfer clone

Withdrawal

. [Mainnet] User funds CommunityPool ETH for exit
. [SKALE Chain] User exits from TokenManager
. [Mainnet] User can now transfer ERC1155


